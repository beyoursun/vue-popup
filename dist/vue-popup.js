!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.VuePopup=t():e.VuePopup=t()}(this,function(){return function(e){function t(n){if(i[n])return i[n].exports;var o=i[n]={i:n,l:!1,exports:{}};return e[n].call(o.exports,o,o.exports,t),o.l=!0,o.exports}var i={};return t.m=e,t.c=i,t.i=function(e){return e},t.d=function(e,i,n){t.o(e,i)||Object.defineProperty(e,i,{configurable:!1,enumerable:!0,get:n})},t.n=function(e){var i=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(i,"a",i),i},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="/dist/",t(t.s=3)}([function(e,t){e.exports={inserted:function(e,t,i){var n=i.context.$refs[t.arg];n&&n.addItem({el:e,value:t.value})},unbind:function(e,t,i){var n=i.context.$refs[t.arg];n&&n.removeItem({el:e,value:t.value})}}},function(e,t,i){var n=i(4)(i(2),i(5),null,null,null);e.exports=n.exports},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default={name:"Popup",props:{appendToBody:{type:Boolean,default:!0},arrowClass:String,direction:{type:String,default:"bottom"},display:{type:Boolean,default:!1},padding:{type:Number,default:0},trigger:{type:String,default:"hover"},scrollShow:{type:Boolean,default:!0}},data:function(){return{arrowStyle:{},delay:100,directionMap:{top:"height",left:"width"},secondDirection:"",left:0,top:0,currentElement:null,willHide:!1}},computed:{directionClass:function(){return""===this.secondDirection?"popup-"+this.direction:"popup-"+this.secondDirection},triggerEvent:function(){switch(this.trigger){case"hover":return"mouseenter";case"focus":return"focus";case"click":return"click"}},unTriggerEl:function(){return"click"===this.trigger?document:this.$el},unTriggerEvent:function(){switch(this.trigger){case"hover":return"mouseleave";case"focus":return"blur";case"click":return"click"}}},mounted:function(){this.appendToBody&&document.body.appendChild(this.$el),this.$el.addEventListener(this.triggerEvent,this.handlePopupVisible),this.unTriggerEl.addEventListener(this.unTriggerEvent,this.handlePopupInvisible)},beforeDestroy:function(){console.log("beforeDestory"),this.$el.removeEventListener(this.triggerEvent,this.handlePopupVisible),this.unTriggerEl.removeEventListener(this.unTriggerEvent,this.handlePopupInvisible)},destroyed:function(){console.log("destoryed",this.$el,this.appendToBody,document.body.hasChildNodes(this.$el)),this.appendToBody&&this.$el&&document.body.hasChildNodes(this.$el)&&document.body.removeChild(this.$el)},methods:{addItem:function(e){e.el.handleVisible=this.handleVisible.bind(this,e.value,e.el),e.el.addEventListener(this.triggerEvent,e.el.handleVisible),"click"!==this.trigger&&(e.el.handleInvisible=this.handleInvisible.bind(this,e.value),e.el.addEventListener(this.unTriggerEvent,e.el.handleInvisible)),this.bindScroll(e.el)},removeItem:function(e){e.el.removeEventListener(this.triggerEvent,e.el.handleVisible),"click"!==this.trigger&&e.el.removeEventListener(this.unTriggerEvent,e.el.handleInvisible),this.unbindScroll(e.el)},bindScroll:function(e){for(e=e.parentNode;e;)e.addEventListener("scroll",this.handleScroll),e=e.parentNode},unbindScroll:function(e){for(e=e.parentNode;e;)e.removeEventListener("scroll",this.handleScroll),e=e.parentNode},computePosition:function(e,t){e=e.getBoundingClientRect(),t=t.getBoundingClientRect();var i=0,n=0,o=t.top-e.height-this.padding,r=t.left+t.width+this.padding,s=t.top+t.height+this.padding,l=t.left-e.width-this.padding;"top"===this.direction||"bottom"===this.direction?(i=t.left+(t.width-e.width)/2,i<0?(i=0,this.arrowStyle={left:(t.left+t.right)/2+"px"}):i+e.width>window.innerWidth?(i=window.innerWidth-e.width,this.arrowStyle={left:(t.left+t.right)/2-i+"px"}):delete this.arrowStyle.left,"top"===this.direction?o<0&&s+e.height<=window.innerHeight?(n=s,this.secondDirection="bottom"):(n=o,this.secondDirection=""):s+e.height>window.innerHeight&&o>=0?(n=o,this.secondDirection="top"):(n=s,this.secondDirection="")):"left"!==this.direction&&"right"!==this.direction||(n=t.top+(t.height-e.height)/2,n<0?(n=0,this.arrowStyle={top:(t.top+t.bottom)/2+"px"}):n+e.height>window.innerHeight?(n=window.innerHeight-e.height,this.arrowStyle={top:(t.top+t.bottom)/2-n+"px"}):delete this.arrowStyle.top,"left"===this.direction?l<0&&r+e.width<=window.innerWidth?(i=r,this.secondDirection="right"):(i=l,this.secondDirection=""):r+e.width>window.innerWidth&&l>=0?(i=l,this.secondDirection="left"):(i=r,this.secondDirection="")),this.top=n,this.left=i},handleVisible:function(e,t,i){var n=this;this.willHide=!1,this.currentElement=t,this.$emit("update:display",!0),this.$emit("show",e),this.$nextTick(function(){n.computePosition(n.$el,n.currentElement)})},handleInvisible:function(e,t){var i=this;"click"===this.trigger?(this.$emit("update:display",!1),this.$emit("hide",e)):(this.willHide=!0,setTimeout(function(){i.willHide&&(i.$emit("update:display",!1),i.$emit("hide",e))},this.delay))},handleScroll:function(){this.scrollShow?this.display&&this.computePosition(this.$el,this.currentElement):(this.$emit("update:display",!1),this.$emit("hide"))},handlePopupVisible:function(e){e.stopPropagation(),this.willHide=!1,this.$emit("update:display",!0),this.$emit("show",this.value)},handlePopupInvisible:function(e){var t=this;"click"===this.trigger&&this.isClosest(e.target,this.currentElement)||("click"===this.trigger?(this.$emit("update:display",!1),this.$emit("hide",this.value)):(this.willHide=!0,setTimeout(function(){t.willHide&&(t.$emit("update:display",!1),t.$emit("hide",t.value))},this.delay)))},isDirectionLine:function(e){return"top"===e||"bottom"===e?"top"===this.direction||"bottom"===this.direction:"left"===this.direction||"right"===this.direction},isClosest:function(e,t){return e!==document&&(e===t||this.isClosest(e.parentNode,t))}}}},function(e,t,i){var n=i(0),o=i(1);o.install=function(e){e.directive("popup",n),e.component(o.name,o)},e.exports=o},function(e,t){e.exports=function(e,t,i,n,o){var r,s=e=e||{},l=typeof e.default;"object"!==l&&"function"!==l||(r=e,s=e.default);var d="function"==typeof s?s.options:s;t&&(d.render=t.render,d.staticRenderFns=t.staticRenderFns),n&&(d._scopeId=n);var h;if(o?(h=function(e){e=e||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext,e||"undefined"==typeof __VUE_SSR_CONTEXT__||(e=__VUE_SSR_CONTEXT__),i&&i.call(this,e),e&&e._registeredComponents&&e._registeredComponents.add(o)},d._ssrRegister=h):i&&(h=i),h){var c=d.functional,u=c?d.render:d.beforeCreate;c?d.render=function(e,t){return h.call(t),u(e,t)}:d.beforeCreate=u?[].concat(u,h):[h]}return{esModule:r,exports:s,options:d}}},function(e,t){e.exports={render:function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{class:e.directionClass,style:{display:e.display?"block":"none",left:e.left+"px",top:e.top+"px"},attrs:{tabindex:"999"}},[e._t("default"),e._v(" "),i("span",{staticClass:"popup-arrow",class:e.arrowClass,style:e.arrowStyle})],2)},staticRenderFns:[]}}])});